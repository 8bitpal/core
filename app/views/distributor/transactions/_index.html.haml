.row-fluid
  .span12
    = form_tag(change_balance_distributor_account_path(@account, anchor: 'transactions'), method: :put, class: 'form-inline') do
      %table#transactions.table.table-bordered.table-striped.no-horizontal-dividers{ data: { account: @account.id } }
        %thead
          %tr
            %th Processed
            %th Date
            %th Details
            %th.text-right Transaction
            %th.text-right Balance

        %tbody
          %tr#new-transaction.new-form
            %td
              .new-form-input
            %td
              .new-form-input= text_field_tag 'date', Time.zone.today.to_s(:date_picker), id: 'transaction_date', class: 'input-small'
            %td
              .new-form-input= text_area_tag 'note', '', rows: 1, placeholder: 'e.g. Discount Credit Applied', class: 'input-xlarge'
            %td
              .new-form-input= text_field_tag 'delta', '0.00', required: 'required', class: 'input-mini'
            %td
              .new-form-input=submit_tag 'Add', class: 'btn btn-primary'

          - running_balance = @transactions_sum

          - @transactions.each do |transaction|
            - td_class = (transaction.manual? ? '' : 'auto')

            %tr{ class: td_class }
              %td= transaction.created_at.to_s(:transaction)
              %td= transaction.display_time.to_s(:transaction)
              %td= transaction.description
              %td.text-right= transaction.amount
              %td.text-right
                %strong= running_balance

            - running_balance -= transaction.amount

          %tr
            %td#more-transactions{ colspan: 5 }
              = link_to 'more...', '#'
              #ajax-loader
