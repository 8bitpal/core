- title 'Customers', false
= render 'controls'
= intro_tour(@show_tour)

%table#customers.table.table-striped
  %thead
    %tr.muted
      %th{ colspan: 2 } Customer
      %th{ colspan: 3 } Next Delivery
      %th.balance Balance

  %tbody
    - if @customers.blank?
      %tr.new-row
        %td{ colspan: 6 }= link_to 'Create a new customer', new_distributor_customer_path
    - else
      %tr.new-row
        %td{ colspan: 6 }= link_to 'Create a new customer', new_distributor_customer_path

      - @customers.each do |customer|
        %tr
          %td= customer_badge(customer)
          %td
            - if customer.halted?
              %span.label.label-info.halted HALTED

            = render partial: 'customer_tags', locals: { customer: customer }
          %td
            %small= next_customer_delivery_occurrence(customer)
          %td
            %small= next_customer_delivery_box_name(customer)
          %td
            %small= customer.account.route.name
          %td.balance{ class: "#{'negative' if customer.account.balance.negative?}" }= customer.account.balance

