- unless @orders.blank?
  #delivery-listings.row
    .three.columns
      .row.data-headings
        %h5.twelve.columns= @selected_date.strftime("%A %m %B") if @selected_date
      .row
        .twelve.columns
          %h6.route-name== #{@orders.size} - #{@route.name}
      .row
        .twelve.columns
          %h6.route-name Summary
          %ul
            - @orders.group_by(&:box_id).each do |box_id, array|
              %li== #{array.size} - #{Box.find(box_id).name}

    .nine.columns
      .row.data-headings
        .one.columns= check_box_tag 'all'
        .nine.columns.delivery_actions
          = button_tag 'Delivered', :class => 'nice small button', :id => 'delivered', :disabled => @selected_date.future?
          = button_tag 'Pending', :class => 'nice small button', :id => 'pending', :disabled => @selected_date.future?
          = button_tag 'Missed', :class => 'nice small button', :id => 'missed', :disabled => @selected_date.future?
          .has-flyout
            %table.flyout.large
              %tr
                %td= radio_button_tag 'missed', 'cancel'
                %td= label_tag 'missed_cancelled', 'Cancel delivery'
                %td
              %tr
                %td= radio_button_tag 'missed', 'reschedule'
                %td= label_tag 'missed_reschedule', 'Reschedule delivery'
                %td= select_tag "people", options_from_collection_for_select(Route.best_route(current_distributor).schedule.next_occurrences(5), 'to_date', 'to_date')
              %tr
                %td= radio_button_tag 'missed', 'pack'
                %td= label_tag 'missed_pack', 'Repack delivery'
                %td= select_tag "people", options_from_collection_for_select(Route.best_route(current_distributor).schedule.next_occurrences(5), 'to_date', 'to_date')
              %tr
                %td{:colspan => 2}
                %td= button_tag 'Commit', :class => 'nice small button'
        .two.columns

      - @orders.each do |order|
        .row.data-listings{:class => order.check_status_by_date(@selected_date)}
          .one.columns= check_box_tag order.id, "1", false, :data => {:delivery => order.delivery_for_date(@selected_date).id}
          .five.columns= delivery_item_address(order)
          .three.columns== #{order.quantity} - #{order.box.name}
          .three.columns= order.customer.name

  :javascript
    $(function() {
      $('#delivery-listings #delivered').click(function() {
        id = $(this).attr('id');
        distributor_id = "#{current_distributor.id}";
        checked_deliveries = $('#delivery-listings .data-listings input[type=checkbox]:checked');

        updateDeliveryStatus(id, distributor_id, checked_deliveries);

        return false;
      });
    });
