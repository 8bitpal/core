.row-fluid.data-headings
  #route-controls.span7.delivery-actions
    = check_box_tag 'all'
    .btn-group
      = button_tag class: !@real_list ? 'btn' : 'btn btn-primary', id: 'delivered', disabled: !@real_list do
        %i.icon-ok-sign.icon-white
        Delivered
      = button_tag class: "btn#{' btn-primary' if @real_list} dropdown-toggle", data: { toggle: 'dropdown' }, disabled: !@real_list do
        %span.caret
      %ul#missed-options.dropdown-menu{ role: 'menu' }
        %li
          = link_to '#', id: 'pending', tabindex: -1 do
            %i.icon-time
            Delivery Pending
        %li
          = link_to '#', id: 'cancelled', tabindex: -1 do
            %i.icon-remove-sign
            Delivery Cancelled
        %li.divider
        %li= link_to 'Apply Payment On Delivery', '#', id: 'payment-on-delivery', tabindex: -1
        %li= link_to 'Undo Payment', '#', id: 'undo-payment', tabindex: -1

  .span5.export.text-right
    = button_to('Export',
      export_distributor_deliveries_path,
      { id: 'delivery-export', class: 'btn', disabled: !@real_list })

.row-fluid.data-headings

- if @real_list
  %ul#delivery_list.unstyled{ class: (@delivery_list.date.past? ? '' : 'sortable') }
    - @items.group_by{ |delivery| delivery.order.address.address_hash }.each do |addressh_hash, deliveries|
      %li.row-fluid
        .span12
          %ul.unstyled
            - deliveries.each do |delivery|
              %li.row-fluid.data-listings{ class: delivery.status, data: { delivery_id: delivery.id } }
                .span2
                  .row-fluid
                    .span8
                      = check_box_tag delivery.order_id, '1', false, data: { delivery: delivery.id }
                      = render partial: 'status_icons', locals: { status: delivery.status }
                    .span2
                      %strong= delivery.delivery_number
                    .span2
                      %span.paid-label.label.label-success{ style: "#{'display: inline;' if delivery.paid?}" } PAID
                .span10
                  .row-fluid
                    .span4= display_address(delivery)
                    .span4= contents_description(delivery)
                    .span4= customer_badge(delivery.customer, customer_name: delivery.package.archived_customer_name, short: true)
- else
  %ul.unstyled
    - @items.each do |order|
      %li.row-fluid.data-listings.pending
        .span2
          .row-fluid
            .span12
              = check_box_tag order.id, '1', false
              .label.state-label.status-pending{ title: 'PENDING delivery' }
                %i.icon-time
        .span10
          .row-fluid
            .span3= display_address(order)
            .span4= contents_description(order)
            .span5= customer_badge(order.customer)
